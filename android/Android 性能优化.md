# Android 性能优化

一般来说，程序的性能通过以下三个方面来表现:

1. 程序的响应速度和时间.
2. 程序的启动时间
3. 内存使用量或者是否存在内存泄漏

一些可以用于定量评测的性能指标有:响应时间,内存占用,磁盘I/O,网络I/O,CPU时间等.

## 开发时优化

### 系统设计
  
1. 选择合适的框架,合适的架构,依赖库时注意其性能和兼容性.
2. 复杂计算可以使用C/C++(NDK 开发)
3. 按需求控制消耗内存还是消耗CPU(空间和时间的关系), 比如可以缓存一些常用的变量在内存中.
4. 控制好服务,线程的创建和使用.  
5. 在网络上可以自定义协议, 如果可以,也可以使用PB协议等现有适合的协议.
6. 如果你的APP比较大, 尽量在启动时初始化好一些常用数据, 不要太单纯的仅仅在那边放广告,减少使用广播.
7. 不是特别需要的SDK 可以放到后边初始化

### 代码调优

1. 比如应该使用LinkedList还是ArrayList. 使用一些合适的设计模式, 比如单例模式(注意内存泄漏),工厂模式,代理模式,观察者模式等.谨慎使用静态变量, 如果不会再使用时记得清空
2. 控制代码质量, 多数人写代码是不在乎警告的, 这一点非常不好, 出现警告是因为编译器检查出可能有内存泄漏,空指针异常,频繁创建对象(常见的onDraw中创建画笔)等, 修复警告可以极大避免运行时出现的错误.
3. 过期的API尽量不要使用. 布局时减少不必要的XML嵌套,使用include和merge增加复用, 如有必要可以使用Java实现XML的功能, 减少解析XML耗时, 为了用户体验可以适当的增加或删减动画.

## 后期分析

### ANR 分析

### 内存泄漏分析

## UI 优化

## 一些Android中常见却没人注意的Bug

1. 首屏问题: 除去某些设计不给跳过广告,跳过按钮是假的,或者跳过就是点击之外, 有一种应该就不是设计的问题了. 启动首屏广告页之后, APP回到后台,用户进入桌面,过几秒APP会自动回到前台. 这个问题原因很简单,我就不说了
2. 微信在信号不好情况下, 会弹出切换网络(节点)的建议对话框,如果此时微信在后台,微信就会悄悄的崩溃. 这个问题不是什么后台保存状态的问题, 仅仅是Activity onpuse 时就不要在再操作和他相关的内容了, 比如更改UI,弹出对话框, 如果想做就把操作记下来, onresume 时再去做.
